local library = {}

function library:AddWindow(titleText, options)
	local player = game:GetService("Players").LocalPlayer

	-- Remove old GUI if it exists
	local existing = game:GetService("CoreGui"):FindFirstChild("lume")
	if existing then existing:Destroy() end

	-- Create ScreenGui
	local gui = Instance.new("ScreenGui")
	gui.Name = "lume"
	gui.Parent = player:WaitForChild("PlayerGui")

	-- Main Frame
	local mainFrame = Instance.new("Frame")
	mainFrame.Size = UDim2.new(0, options.min_size.X, 0, options.min_size.Y)
	mainFrame.Position = UDim2.new(0.5, -options.min_size.X / 2, 0.5, -options.min_size.Y / 2)
	mainFrame.BackgroundColor3 = options.main_color or Color3.fromRGB(30, 30, 30)
	mainFrame.BorderSizePixel = 0
	mainFrame.Active = true
	mainFrame.Draggable = true
	mainFrame.Parent = gui

	-- Rounded Corners
	local corner = Instance.new("UICorner")
	corner.CornerRadius = UDim.new(0, 10)
	corner.Parent = mainFrame

	-- Top Bar (Color changed to use options.main_color)
	local topBar = Instance.new("Frame")
	topBar.Size = UDim2.new(1, 0, 0, 30)
	topBar.BackgroundColor3 = options.main_color or Color3.fromRGB(255, 0, 0)  -- Use main_color for top bar
	topBar.BorderSizePixel = 0
	topBar.Parent = mainFrame

	-- Title
	local title = Instance.new("TextLabel")
	title.Size = UDim2.new(0, 200, 1, 0)
	title.Position = UDim2.new(0, 10, 0, 0)
	title.BackgroundTransparency = 1
	title.Text = titleText
	title.TextColor3 = Color3.fromRGB(255, 255, 255)
	title.Font = Enum.Font.GothamSemibold
	title.TextSize = 14
	title.TextXAlignment = Enum.TextXAlignment.Left
	title.Parent = topBar

	-- Minimize Button
	local minimizeButton = Instance.new("TextButton")
	minimizeButton.Size = UDim2.new(0, 30, 0, 30)
	minimizeButton.Position = UDim2.new(1, -35, 0, 0)
	minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
	minimizeButton.Text = "-"
	minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
	minimizeButton.Font = Enum.Font.GothamSemibold
	minimizeButton.TextSize = 18
	minimizeButton.BorderSizePixel = 0
	minimizeButton.Parent = topBar

	-- Content Holder
	local contentHolder = Instance.new("Frame")
	contentHolder.Name = "ContentHolder"
	contentHolder.Size = UDim2.new(1, 0, 1, -30)
	contentHolder.Position = UDim2.new(0, 0, 0, 30)
	contentHolder.BackgroundTransparency = 1
	contentHolder.Parent = mainFrame

	local TweenService = game:GetService("TweenService")
	local isMinimized = false

	minimizeButton.MouseButton1Click:Connect(function()
		isMinimized = not isMinimized
		contentHolder.Visible = not isMinimized

		local targetSize = isMinimized and UDim2.new(0, options.min_size.X, 0, 30)
			or UDim2.new(0, options.min_size.X, 0, options.min_size.Y)

		local tweenInfo = TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
		TweenService:Create(mainFrame, tweenInfo, {Size = targetSize}):Play()

		minimizeButton.Text = isMinimized and "+" or "-"
	end)

	return mainFrame
end

return library
