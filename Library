local library = {}

-- Internal tables
library.windows = {}

-- Create new window
function library:AddWindow(title, options)
	local options = options or {}
	local main_color = options.main_color or Color3.fromRGB(255, 0, 0)
	local min_size = options.min_size or Vector2.new(600, 350)
	local can_resize = options.can_resize or false

	local window = {}
	window.tabs = {}

	-- UI setup
	local ScreenGui = Instance.new("ScreenGui", game.Players.LocalPlayer:WaitForChild("PlayerGui"))
	ScreenGui.Name = "LumeLibrary"
	ScreenGui.ResetOnSpawn = false

	local Main = Instance.new("Frame", ScreenGui)
	Main.Name = title
	Main.Size = UDim2.new(0, min_size.X, 0, min_size.Y)
	Main.Position = UDim2.new(0.5, -min_size.X/2, 0.5, -min_size.Y/2)
	Main.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	Main.BorderSizePixel = 0
	Main.Active = true
	Main.Draggable = true

	local Title = Instance.new("TextLabel", Main)
	Title.Size = UDim2.new(1, 0, 0, 40)
	Title.BackgroundColor3 = main_color
	Title.Text = title
	Title.TextColor3 = Color3.fromRGB(255, 255, 255)
	Title.Font = Enum.Font.GothamBold
	Title.TextSize = 20

	local TabsBar = Instance.new("Frame", Main)
	TabsBar.Size = UDim2.new(0, 100, 1, -40)
	TabsBar.Position = UDim2.new(0, 0, 0, 40)
	TabsBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)

	local ContentArea = Instance.new("Frame", Main)
	ContentArea.Size = UDim2.new(1, -100, 1, -40)
	ContentArea.Position = UDim2.new(0, 100, 0, 40)
	ContentArea.BackgroundColor3 = Color3.fromRGB(35, 35, 35)

	function window:AddTab(tab_name)
		local tab = {}
		tab.buttons = {}

		-- Tab button
		local TabButton = Instance.new("TextButton", TabsBar)
		TabButton.Size = UDim2.new(1, 0, 0, 40)
		TabButton.Position = UDim2.new(0, 0, 0, #window.tabs * 40)
		TabButton.BackgroundColor3 = main_color
		TabButton.Text = tab_name
		TabButton.Font = Enum.Font.Gotham
		TabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
		TabButton.TextSize = 14

		-- Tab content frame
		local TabFrame = Instance.new("ScrollingFrame", ContentArea)
		TabFrame.Name = tab_name
		TabFrame.Size = UDim2.new(1, 0, 1, 0)
		TabFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
		TabFrame.BackgroundTransparency = 1
		TabFrame.ScrollBarThickness = 4
		TabFrame.Visible = #window.tabs == 0 -- only first tab is visible

		local Layout = Instance.new("UIListLayout", TabFrame)
		Layout.Padding = UDim.new(0, 6)

		-- Hide other tabs on click
		TabButton.MouseButton1Click:Connect(function()
			for _, child in ipairs(ContentArea:GetChildren()) do
				if child:IsA("Frame") or child:IsA("ScrollingFrame") then
					child.Visible = false
				end
			end
			TabFrame.Visible = true
		end)

		function tab:AddButton(text, callback)
			local btn = Instance.new("TextButton", TabFrame)
			btn.Size = UDim2.new(1, -10, 0, 30)
			btn.BackgroundColor3 = main_color
			btn.Text = text
			btn.Font = Enum.Font.Gotham
			btn.TextColor3 = Color3.fromRGB(255, 255, 255)
			btn.TextSize = 14

			btn.MouseButton1Click:Connect(callback)

			TabFrame.CanvasSize = UDim2.new(0, 0, 0, TabFrame.UIListLayout.AbsoluteContentSize.Y + 10)
		end

		table.insert(window.tabs, tab)
		return tab
	end

	table.insert(library.windows, window)
	return window
end

return library
